% R_se * f_1 - R_1 * g_b = 0
% R_se * f_2 - R_2 * g_b = 0
% a^2 + b^2 + c^2 + d^2 = 1

function [a, b, c, d, g1, g2, g3] = grobner_solver( f1, f2, R1, R2)
    % f11, f12, f13, f21, f22, f23, r111, r112, r113, r121, r122, r123, r131, r132, r133, r211, r212, r213, r221, r222, r223, r231, r232, r233
    f11 = f1(1);
    f12 = f1(2);
    f13 = f1(3);
    f21 = f2(1);
    f22 = f2(2);
    f23 = f2(3);
    r111 = R1(1,1);
    r112 = R1(1,2);
    r113 = R1(1,3);
    r121 = R1(2,1);
    r122 = R1(2,2);
    r123 = R1(2,3);
    r131 = R1(3,1);
    r132 = R1(3,2);
    r133 = R1(3,3);
    r211 = R2(1,1);
    r212 = R2(1,2);
    r213 = R2(1,3);
    r221 = R2(2,1);
    r222 = R2(2,2);
    r223 = R2(2,3);
    r231 = R2(3,1);
    r232 = R2(3,2);
    r233 = R2(3,3);
	% precalculate polynomial equations coefficients
	c(1) = -2*f11;
	c(2) = -2*f11;
	c(3) = 2*f13;
	c(4) = 2*f12;
	c(5) = -2*f12;
	c(6) = 2*f13;
	c(7) = -r113;
	c(8) = -r112;
	c(9) = -r111;
	c(10) = f11;
	c(11) = -2*f12;
	c(12) = -2*f12;
	c(13) = 2*f13;
	c(14) = 2*f11;
	c(15) = 2*f11;
	c(16) = -2*f13;
	c(17) = -r123;
	c(18) = -r122;
	c(19) = -r121;
	c(20) = f12;
	c(21) = -2*f13;
	c(22) = -2*f13;
	c(23) = 2*f12;
	c(24) = 2*f11;
	c(25) = -2*f11;
	c(26) = 2*f12;
	c(27) = -r133;
	c(28) = -r132;
	c(29) = -r131;
	c(30) = f13;
	c(31) = -2*f21;
	c(32) = -2*f21;
	c(33) = 2*f23;
	c(34) = 2*f22;
	c(35) = -2*f22;
	c(36) = 2*f23;
	c(37) = -r213;
	c(38) = -r212;
	c(39) = -r211;
	c(40) = f21;
	c(41) = -2*f22;
	c(42) = -2*f22;
	c(43) = 2*f23;
	c(44) = 2*f21;
	c(45) = 2*f21;
	c(46) = -2*f23;
	c(47) = -r223;
	c(48) = -r222;
	c(49) = -r221;
	c(50) = f22;
	c(51) = -2*f23;
	c(52) = -2*f23;
	c(53) = 2*f22;
	c(54) = 2*f21;
	c(55) = -2*f21;
	c(56) = 2*f22;
	c(57) = -r233;
	c(58) = -r232;
	c(59) = -r231;
	c(60) = f23;
	c(61) = 1;
	c(62) = 1;
	c(63) = 1;
	c(64) = 1;
	c(65) = -1;

	M1 = zeros(7, 14);
	M1(64) = c(1);
	M1(36) = c(2);
	M1(50) = c(3);
	M1(29) = c(4);
	M1(43) = c(5);
	M1(22) = c(6);
	M1(85) = c(7);
	M1(78) = c(8);
	M1(71) = c(9);
	M1(92) = c(10);
	M1(65) = c(11);
	M1(16) = c(12);
	M1(58) = c(13);
	M1(30) = c(14);
	M1(44) = c(15);
	M1(9) = c(16);
	M1(86) = c(17);
	M1(79) = c(18);
	M1(72) = c(19);
	M1(93) = c(20);
	M1(38) = c(21);
	M1(17) = c(22);
	M1(59) = c(23);
	M1(52) = c(24);
	M1(24) = c(25);
	M1(10) = c(26);
	M1(87) = c(27);
	M1(80) = c(28);
	M1(73) = c(29);
	M1(94) = c(30);
	M1(67) = c(31);
	M1(39) = c(32);
	M1(53) = c(33);
	M1(32) = c(34);
	M1(46) = c(35);
	M1(25) = c(36);
	M1(88) = c(37);
	M1(81) = c(38);
	M1(74) = c(39);
	M1(95) = c(40);
	M1(68) = c(41);
	M1(19) = c(42);
	M1(61) = c(43);
	M1(33) = c(44);
	M1(47) = c(45);
	M1(12) = c(46);
	M1(89) = c(47);
	M1(82) = c(48);
	M1(75) = c(49);
	M1(96) = c(50);
	M1(41) = c(51);
	M1(20) = c(52);
	M1(62) = c(53);
	M1(55) = c(54);
	M1(27) = c(55);
	M1(13) = c(56);
	M1(90) = c(57);
	M1(83) = c(58);
	M1(76) = c(59);
	M1(97) = c(60);
	M1(70) = c(61);
	M1(42) = c(62);
	M1(21) = c(63);
	M1(7) = c(64);
	M1(98) = c(65);

	M1 = rref(M1);

	M2 = zeros(56, 86);
	M2(50:56, [51 52 53 54 55 56 57 58 59 60 83 84 85 86]) = M1(1:7, :);
	M2([1 58 227 564 1125 1686 2247]) = M1(1);
	M2([64 121 290 627 1188 1749 2310]) = M1(9);
	M2([127 184 353 690 1251 1812 2373]) = M1(17);
	M2([246 303 416 753 1314 1875 2436]) = M1(25);
	M2([309 366 479 816 1377 1938 2499]) = M1(33);
	M2([428 485 542 879 1440 2001 2562]) = M1(41);
	M2([603 660 773 942 1503 2064 2625]) = M1(49);
	M2([617 674 787 956 1517 2078 2639]) = M1(50);
	M2([624 681 794 963 1524 2085 2646]) = M1(51);
	M2([631 688 801 970 1531 2092 2653]) = M1(52);
	M2([638 695 808 977 1538 2099 2660]) = M1(53);
	M2([645 702 815 984 1545 2106 2667]) = M1(54);
	M2([652 709 822 991 1552 2113 2674]) = M1(55);
	M2([659 716 829 998 1559 2120 2681]) = M1(56);
	M2([729 786 843 1012 1573 2134 2695]) = M1(57);
	M2([736 793 850 1019 1580 2141 2702]) = M1(58);
	M2([743 800 857 1026 1587 2148 2709]) = M1(59);
	M2([750 807 864 1033 1594 2155 2716]) = M1(60);
	M2([757 814 871 1040 1601 2162 2723]) = M1(61);
	M2([764 821 878 1047 1608 2169 2730]) = M1(62);
	M2([771 828 885 1054 1615 2176 2737]) = M1(63);
	M2([897 954 1011 1068 1629 2190 2751]) = M1(64);
	M2([904 961 1018 1075 1636 2197 2758]) = M1(65);
	M2([911 968 1025 1082 1643 2204 2765]) = M1(66);
	M2([918 975 1032 1089 1650 2211 2772]) = M1(67);
	M2([925 982 1039 1096 1657 2218 2779]) = M1(68);
	M2([932 989 1046 1103 1664 2225 2786]) = M1(69);
	M2([3361 3418 3475 3532 3589 3870 4207]) = M1(71);
	M2([3368 3425 3482 3539 3596 3877 4214]) = M1(72);
	M2([3375 3432 3489 3546 3603 3884 4221]) = M1(73);
	M2([3382 3439 3496 3553 3610 3891 4228]) = M1(74);
	M2([3389 3446 3503 3560 3617 3898 4235]) = M1(75);
	M2([3396 3453 3510 3567 3624 3905 4242]) = M1(76);
	M2([3403 3460 3517 3574 3631 3912 4249]) = M1(77);
	M2([3641 3698 3755 3812 3869 3926 4263]) = M1(78);
	M2([3648 3705 3762 3819 3876 3933 4270]) = M1(79);
	M2([3655 3712 3769 3826 3883 3940 4277]) = M1(80);
	M2([3662 3719 3776 3833 3890 3947 4284]) = M1(81);
	M2([3669 3726 3783 3840 3897 3954 4291]) = M1(82);
	M2([3676 3733 3790 3847 3904 3961 4298]) = M1(83);
	M2([3683 3740 3797 3854 3911 3968 4305]) = M1(84);
	M2([3977 4034 4091 4148 4205 4262 4319]) = M1(85);
	M2([3984 4041 4098 4155 4212 4269 4326]) = M1(86);
	M2([3991 4048 4105 4162 4219 4276 4333]) = M1(87);
	M2([3998 4055 4112 4169 4226 4283 4340]) = M1(88);
	M2([4005 4062 4119 4176 4233 4290 4347]) = M1(89);
	M2([4012 4069 4126 4183 4240 4297 4354]) = M1(90);
	M2([4019 4076 4133 4190 4247 4304 4361]) = M1(91);
	M2([4369 4426 4483 4540 4597 4654 4711]) = M1(92);
	M2([4376 4433 4490 4547 4604 4661 4718]) = M1(93);
	M2([4383 4440 4497 4554 4611 4668 4725]) = M1(94);
	M2([4390 4447 4504 4561 4618 4675 4732]) = M1(95);
	M2([4397 4454 4511 4568 4625 4682 4739]) = M1(96);
	M2([4404 4461 4518 4575 4632 4689 4746]) = M1(97);
	M2 = rref(M2);

	M3 = zeros(94, 110);
	M3(39:94, [1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 35 36 37 38 39 40 41 42 43 44 53 54 55 56 57 58 59 60 61 62 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110]) = M2(1:56, :);
	M3([2821 4138 5831]) = M2(3409);
	M3([2918 4235 5928]) = M2(3466);
	M3([2639 3016 4333 6026]) = M2(3523);
	M3([2455 2550 2645 2740 3117 4434 6127]) = M2(3580);
	M3([4154 4531 6224]) = M2(3693);
	M3([3875 4252 4629 6322]) = M2(3750);
	M3([3503 3598 3693 3976 4353 4730 6423]) = M2(3807);
	M3([3792 3887 3982 4077 4454 4831 6524]) = M2(3864);
	M3([5829 6206 6583]) = M2(4025);
	M3([5832 6209 6586]) = M2(4026);
	M3([5459 5836 6213 6590]) = M2(4027);
	M3([4899 4994 5183 5466 5843 6220 6597]) = M2(4028);
	M3([5846 6223 6600]) = M2(4029);
	M3([5473 5850 6227 6604]) = M2(4030);
	M3([4913 5008 5197 5480 5857 6234 6611]) = M2(4031);
	M3([4920 5015 5204 5487 5864 6241 6618]) = M2(4032);
	M3([5923 6300 6677]) = M2(4081);
	M3([5926 6303 6680]) = M2(4082);
	M3([5553 5930 6307 6684]) = M2(4083);
	M3([4993 5088 5277 5560 5937 6314 6691]) = M2(4084);
	M3([5940 6317 6694]) = M2(4085);
	M3([5567 5944 6321 6698]) = M2(4086);
	M3([5007 5102 5291 5574 5951 6328 6705]) = M2(4087);
	M3([5014 5109 5298 5581 5958 6335 6712]) = M2(4088);
	M3([6017 6394 6771]) = M2(4137);
	M3([6020 6397 6774]) = M2(4138);
	M3([5647 6024 6401 6778]) = M2(4139);
	M3([5181 5276 5371 5654 6031 6408 6785]) = M2(4140);
	M3([6034 6411 6788]) = M2(4141);
	M3([5661 6038 6415 6792]) = M2(4142);
	M3([5195 5290 5385 5668 6045 6422 6799]) = M2(4143);
	M3([5202 5297 5392 5675 6052 6429 6806]) = M2(4144);
	M3([6111 6488 6865]) = M2(4193);
	M3([6114 6491 6868]) = M2(4194);
	M3([5741 6118 6495 6872]) = M2(4195);
	M3([5463 5558 5653 5748 6125 6502 6879]) = M2(4196);
	M3([6128 6505 6882]) = M2(4197);
	M3([5755 6132 6509 6886]) = M2(4198);
	M3([5477 5572 5667 5762 6139 6516 6893]) = M2(4199);
	M3([5484 5579 5674 5769 6146 6523 6900]) = M2(4200);
	M3([7897 8368 8933]) = M2(4417);
	M3([7900 8371 8936]) = M2(4418);
	M3([7527 7904 8375 8940]) = M2(4419);
	M3([6967 7062 7251 7534 7911 8382 8947]) = M2(4420);
	M3([7914 8385 8950]) = M2(4421);
	M3([7541 7918 8389 8954]) = M2(4422);
	M3([6981 7076 7265 7548 7925 8396 8961]) = M2(4423);
	M3([6988 7083 7272 7555 7932 8403 8968]) = M2(4424);
	M3([7991 8462 9027]) = M2(4473);
	M3([7994 8465 9030]) = M2(4474);
	M3([7621 7998 8469 9034]) = M2(4475);
	M3([7061 7156 7345 7628 8005 8476 9041]) = M2(4476);
	M3([8008 8479 9044]) = M2(4477);
	M3([7635 8012 8483 9048]) = M2(4478);
	M3([7075 7170 7359 7642 8019 8490 9055]) = M2(4479);
	M3([7082 7177 7366 7649 8026 8497 9062]) = M2(4480);
	M3([8085 8556 9121]) = M2(4529);
	M3([8088 8559 9124]) = M2(4530);
	M3([7715 8092 8563 9128]) = M2(4531);
	M3([7249 7344 7439 7722 8099 8570 9135]) = M2(4532);
	M3([8102 8573 9138]) = M2(4533);
	M3([7729 8106 8577 9142]) = M2(4534);
	M3([7263 7358 7453 7736 8113 8584 9149]) = M2(4535);
	M3([7270 7365 7460 7743 8120 8591 9156]) = M2(4536);
	M3([8179 8650 9215]) = M2(4585);
	M3([8182 8653 9218]) = M2(4586);
	M3([7809 8186 8657 9222]) = M2(4587);
	M3([7531 7626 7721 7816 8193 8664 9229]) = M2(4588);
	M3([8196 8667 9232]) = M2(4589);
	M3([7823 8200 8671 9236]) = M2(4590);
	M3([7545 7640 7735 7830 8207 8678 9243]) = M2(4591);
	M3([7552 7647 7742 7837 8214 8685 9250]) = M2(4592);
	M3 = rref(M3);

	M4 = zeros(104, 120);
	M4(11:104, [1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 36 37 38 39 40 41 42 43 44 45 46 47 48 49 51 52 53 54 57 58 59 60 61 62 63 64 65 66 67 68 69 70 72 73 74 75 78 79 80 81 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120]) = M3(1:94, :);
	M4([6761]) = M3(7885);
	M4([3538 5099 7284]) = M3(8360);
	M4([5101 5622 7807]) = M3(8835);
	M4([5624 5729 7914]) = M3(8930);
	M4([8425]) = M3(9389);
	M4([7282 7803 8428]) = M3(9394);
	M4([7285 7806 8431]) = M3(9399);
	M4([7288 7809 8434]) = M3(9400);
	M4([8529]) = M3(9483);
	M4([7802 7907 8532]) = M3(9488);
	M4([7805 7910 8535]) = M3(9493);
	M4([7808 7913 8538]) = M3(9494);
	M4([8633]) = M3(9577);
	M4([8426 8531 8636]) = M3(9582);
	M4([8429 8534 8639]) = M3(9587);
	M4([8432 8537 8642]) = M3(9588);
	M4([11337]) = M3(10047);
	M4([11441]) = M3(10141);
	M4([11545]) = M3(10235);
	M4([12273]) = M3(10329);
	M4([12066 12171 12276]) = M3(10334);
	M4([12069 12174 12279]) = M3(10339);
	M4([12072 12177 12282]) = M3(10340);
	M4 = rref(M4);

	M = zeros(42, 58);
	M(21:42, [21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58]) = M4([57 58 60 63 67 68 69 70 72 73 74 75 78 79 80 81 84 85 87 90 94 99], [57 58 60 63 67 68 69 70 72 73 74 75 78 79 80 81 84 85 86 88 91 95 100 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120]);
	M([1 170 507]) = M4(10395);
	M([46 215 552]) = M4(10500);
	M([91 260 597]) = M4(10605);
	M([136 305 642]) = M4(10710);
	M([13 56 99 142]) = M4(10815);
	M([185 228 271 314]) = M4(10920);
	M([337 506 675]) = M4(11019);
	M([340 509 678]) = M4(11020);
	M([343 512 681]) = M4(11021);
	M([346 515 684]) = M4(11022);
	M([379 548 717]) = M4(11123);
	M([382 551 720]) = M4(11124);
	M([385 554 723]) = M4(11125);
	M([388 557 726]) = M4(11126);
	M([421 590 759]) = M4(11227);
	M([424 593 762]) = M4(11228);
	M([427 596 765]) = M4(11229);
	M([430 599 768]) = M4(11230);
	M([463 632 801]) = M4(11331);
	M([466 635 804]) = M4(11332);
	M([469 638 807]) = M4(11333);
	M([472 641 810]) = M4(11334);
	M([349 392 435 478]) = M4(11439);
	M([353 396 439 482]) = M4(11440);
	M([517 560 603 646]) = M4(11543);
	M([521 564 607 650]) = M4(11544);
	M([685 728 771 814]) = M4(11647);
	M([689 732 775 818]) = M4(11648);
	M([1009 1178 1347]) = M4(11747);
	M([1012 1181 1350]) = M4(11748);
	M([1015 1184 1353]) = M4(11749);
	M([1018 1187 1356]) = M4(11750);
	M([1051 1220 1389]) = M4(11851);
	M([1054 1223 1392]) = M4(11852);
	M([1057 1226 1395]) = M4(11853);
	M([1060 1229 1398]) = M4(11854);
	M([1093 1262 1431]) = M4(11955);
	M([1096 1265 1434]) = M4(11956);
	M([1099 1268 1437]) = M4(11957);
	M([1102 1271 1440]) = M4(11958);
	M([1135 1304 1473]) = M4(12059);
	M([1138 1307 1476]) = M4(12060);
	M([1141 1310 1479]) = M4(12061);
	M([1144 1313 1482]) = M4(12062);
	M([1819 1862 1905 1948]) = M4(12479);
	M([1823 1866 1909 1952]) = M4(12480);
	M = rref(M);

	A = zeros(16);
	amcols = [58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 37];
	A(1, 8) = 1;
	A(2, 15) = 1;
	A(3, :) = -M(42, amcols);
	A(4, :) = -M(41, amcols);
	A(5, :) = -M(40, amcols);
	A(6, :) = -M(39, amcols);
	A(7, :) = -M(38, amcols);
	A(8, :) = -M(37, amcols);
	A(9, :) = -M(33, amcols);
	A(10, :) = -M(29, amcols);
	A(11, :) = -M(25, amcols);
	A(12, :) = -M(24, amcols);
	A(13, :) = -M(23, amcols);
	A(14, :) = -M(22, amcols);
	A(15, :) = -M(21, amcols);
	A(16, :) = -M(17, amcols);

	[V D] = eig(A);
	sol =  V([8, 7, 6, 5, 4, 3, 2],:)./(ones(7, 1)*V(1,:));

	if (find(isnan(sol(:))) > 0)
		
		a = zeros(1, 0);
		b = zeros(1, 0);
		c = zeros(1, 0);
		d = zeros(1, 0);
		g1 = zeros(1, 0);
		g2 = zeros(1, 0);
		g3 = zeros(1, 0);
	else
		
		I = find(not(imag( sol(1,:) )));
		a = sol(1,I);
		b = sol(2,I);
		c = sol(3,I);
		d = sol(4,I);
		g1 = sol(5,I);
		g2 = sol(6,I);
		g3 = sol(7,I);
	end
end